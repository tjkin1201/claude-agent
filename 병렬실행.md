# 병렬 Claude Code 실행 가이드

여러 CLI 창에서 Claude Code를 동시에 실행하여 하나의 프로젝트를 병렬로 개발하는 방법을 설명합니다.

## 📋 목차

1. [개요](#개요)
2. [Windows 환경](#windows-환경)
3. [Linux 환경](#linux-환경)
4. [공통 설정](#공통-설정)
5. [실전 예제](#실전-예제)
6. [문제 해결](#문제-해결)

## 개요

### 병렬 작업의 장점
- **작업 속도 향상**: 여러 작업을 동시에 진행
- **전문화된 작업**: 각 세션이 특정 영역에 집중
- **효율적인 리소스 활용**: CPU 코어를 최대한 활용
- **독립적인 컨텍스트**: 각 세션이 독립된 작업 컨텍스트 유지

### 필요 사항
- Claude Code CLI 설치
- 충분한 시스템 리소스 (RAM 16GB 이상 권장)
- Git (버전 관리용)
- 터미널 멀티플렉서 (선택사항)

## Windows 환경

### 1. Windows Terminal을 사용한 병렬 실행

#### Windows Terminal 설치
```powershell
# Windows Package Manager 사용
winget install Microsoft.WindowsTerminal

# 또는 Microsoft Store에서 설치
```

#### 병렬 탭 실행 스크립트 (PowerShell)

`parallel-claude-windows.ps1` 파일 생성:

```powershell
# 병렬 Claude Code 실행 스크립트
param(
    [int]$SessionCount = 4,
    [string]$ProjectPath = (Get-Location).Path
)

# Windows Terminal 프로필 생성
$sessions = @(
    @{Name="Frontend"; Task="/implement 'UI components' --persona-frontend"; Dir="$ProjectPath\frontend"},
    @{Name="Backend"; Task="/implement 'API endpoints' --persona-backend"; Dir="$ProjectPath\backend"},
    @{Name="Testing"; Task="/test --comprehensive --persona-qa"; Dir="$ProjectPath\tests"},
    @{Name="Docs"; Task="/document --persona-scribe"; Dir="$ProjectPath\docs"}
)

# Windows Terminal 명령 생성
$wtCommand = "wt"

foreach ($session in $sessions) {
    $wtCommand += " new-tab --title `"$($session.Name)`" -d `"$($session.Dir)`" pwsh -NoExit -Command `"claude-code --session $($session.Name.ToLower())`""
}

# Windows Terminal 실행
Invoke-Expression $wtCommand

Write-Host "✅ $SessionCount 개의 Claude Code 세션이 시작되었습니다." -ForegroundColor Green
```

#### 실행 방법
```powershell
# 스크립트 실행 권한 설정 (최초 1회)
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser

# 스크립트 실행
.\parallel-claude-windows.ps1 -SessionCount 4
```

### 2. ConEmu를 사용한 병렬 실행

#### ConEmu 설치
```powershell
# Chocolatey 사용
choco install conemu

# 또는 공식 사이트에서 다운로드
# https://conemu.github.io/
```

#### ConEmu 설정 파일 (`ConEmu-Claude.xml`)

```xml
<?xml version="1.0" encoding="utf-8"?>
<ConEmu>
  <Tasks>
    <Task name="Claude Parallel" hotkey="" GuiArgs="">
      <Commands>
        <Command>-cur_console:n -cur_console:t:"Frontend" cmd /k "cd /d %PROJECT_PATH%\frontend && claude-code --session frontend"</Command>
        <Command>-cur_console:s1TVH -cur_console:t:"Backend" cmd /k "cd /d %PROJECT_PATH%\backend && claude-code --session backend"</Command>
        <Command>-cur_console:s1THV -cur_console:t:"Testing" cmd /k "cd /d %PROJECT_PATH%\tests && claude-code --session testing"</Command>
        <Command>-cur_console:s2THV -cur_console:t:"Docs" cmd /k "cd /d %PROJECT_PATH%\docs && claude-code --session docs"</Command>
      </Commands>
    </Task>
  </Tasks>
</ConEmu>
```

### 3. PowerShell 자동화 스크립트

`start-parallel-sessions.ps1`:

```powershell
# 병렬 세션 관리 스크립트
[CmdletBinding()]
param(
    [Parameter(Mandatory=$false)]
    [int]$Sessions = 4,
    
    [Parameter(Mandatory=$false)]
    [string]$Project = "my-project",
    
    [Parameter(Mandatory=$false)]
    [string[]]$Tasks = @()
)

# 세션 구성
$sessionConfigs = @{
    1 = @{
        Name = "Frontend"
        WorkDir = ".\src\frontend"
        Command = "/implement 'React components' --persona-frontend --magic"
        Focus = "*.jsx,*.tsx,*.css"
    }
    2 = @{
        Name = "Backend"
        WorkDir = ".\src\backend"
        Command = "/implement 'REST API' --persona-backend --seq"
        Focus = "*.js,*.ts,*.sql"
    }
    3 = @{
        Name = "Testing"
        WorkDir = ".\tests"
        Command = "/test --e2e --persona-qa --play"
        Focus = "*.test.js,*.spec.js"
    }
    4 = @{
        Name = "DevOps"
        WorkDir = "."
        Command = "/ci-setup --persona-devops"
        Focus = "Dockerfile,*.yml,*.yaml"
    }
}

# 공유 TODO 파일 생성
$todoPath = ".\.claude\todos\shared-todo.json"
$todoContent = @{
    project = $Project
    created = (Get-Date -Format "yyyy-MM-dd HH:mm:ss")
    sessions = @()
    todos = @()
}

# 각 세션 시작
for ($i = 1; $i -le $Sessions; $i++) {
    $config = $sessionConfigs[$i]
    
    # 새 PowerShell 창 열기
    $startInfo = New-Object System.Diagnostics.ProcessStartInfo
    $startInfo.FileName = "powershell.exe"
    $startInfo.Arguments = "-NoExit -Command `"" +
        "Set-Location '$($config.WorkDir)'; " +
        "Write-Host '🚀 Starting $($config.Name) Session' -ForegroundColor Cyan; " +
        "claude-code --session $($config.Name.ToLower()) --resume; " +
        "$($config.Command)`""
    $startInfo.WorkingDirectory = $config.WorkDir
    
    [System.Diagnostics.Process]::Start($startInfo)
    
    # TODO 리스트에 세션 추가
    $todoContent.sessions += @{
        id = $i
        name = $config.Name
        status = "active"
        focus = $config.Focus
    }
    
    Write-Host "✅ Started session $i: $($config.Name)" -ForegroundColor Green
    Start-Sleep -Seconds 2
}

# 공유 TODO 파일 저장
$todoContent | ConvertTo-Json -Depth 10 | Set-Content $todoPath
Write-Host "`n📋 Shared TODO list created at: $todoPath" -ForegroundColor Yellow

# 모니터링 대시보드 시작 (선택사항)
$monitor = Read-Host "`n모니터링 대시보드를 시작하시겠습니까? (Y/N)"
if ($monitor -eq 'Y') {
    Start-Process powershell -ArgumentList "-NoExit", "-Command", "
        while (`$true) {
            Clear-Host
            Write-Host '=== Claude Code Parallel Sessions Monitor ===' -ForegroundColor Cyan
            Get-Process | Where-Object {`$_.ProcessName -like '*claude*'} | Format-Table
            Start-Sleep -Seconds 5
        }
    "
}
```

## Linux 환경

### 1. tmux를 사용한 병렬 실행

#### tmux 설치
```bash
# Ubuntu/Debian
sudo apt-get install tmux

# RHEL/CentOS/Fedora
sudo yum install tmux

# Arch Linux
sudo pacman -S tmux
```

#### 병렬 실행 스크립트 (`parallel-claude-linux.sh`)

```bash
#!/bin/bash

# 색상 정의
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m' # No Color

# 설정 변수
PROJECT_NAME="${1:-my-project}"
SESSION_COUNT="${2:-4}"
PROJECT_PATH="${3:-$(pwd)}"

# tmux 세션 이름
TMUX_SESSION="claude-parallel-$PROJECT_NAME"

# 기존 세션 종료
tmux kill-session -t $TMUX_SESSION 2>/dev/null

echo -e "${BLUE}🚀 Starting $SESSION_COUNT parallel Claude Code sessions...${NC}"

# 새 tmux 세션 생성
tmux new-session -d -s $TMUX_SESSION -n "Frontend" -c "$PROJECT_PATH/frontend"

# Frontend 세션
tmux send-keys -t $TMUX_SESSION:0.0 "claude-code --session frontend" C-m
sleep 1
tmux send-keys -t $TMUX_SESSION:0.0 "/implement 'UI components' --persona-frontend --magic" C-m

# Backend 세션 (수평 분할)
tmux split-window -h -t $TMUX_SESSION:0 -c "$PROJECT_PATH/backend"
tmux send-keys -t $TMUX_SESSION:0.1 "claude-code --session backend" C-m
sleep 1
tmux send-keys -t $TMUX_SESSION:0.1 "/implement 'API endpoints' --persona-backend --seq" C-m

# Testing 세션 (수직 분할)
tmux split-window -v -t $TMUX_SESSION:0.0 -c "$PROJECT_PATH/tests"
tmux send-keys -t $TMUX_SESSION:0.2 "claude-code --session testing" C-m
sleep 1
tmux send-keys -t $TMUX_SESSION:0.2 "/test --comprehensive --persona-qa --play" C-m

# Documentation 세션 (수직 분할)
tmux split-window -v -t $TMUX_SESSION:0.1 -c "$PROJECT_PATH/docs"
tmux send-keys -t $TMUX_SESSION:0.3 "claude-code --session docs" C-m
sleep 1
tmux send-keys -t $TMUX_SESSION:0.3 "/document --auto --persona-scribe" C-m

# 레이아웃 조정
tmux select-layout -t $TMUX_SESSION:0 tiled

echo -e "${GREEN}✅ All sessions started successfully!${NC}"
echo -e "${YELLOW}📋 To attach to the session, run:${NC}"
echo -e "${BLUE}   tmux attach-session -t $TMUX_SESSION${NC}"

# 선택적: 자동으로 세션에 연결
read -p "Do you want to attach to the session now? (y/n) " -n 1 -r
echo
if [[ $REPLY =~ ^[Yy]$ ]]; then
    tmux attach-session -t $TMUX_SESSION
fi
```

### 2. GNU Screen을 사용한 병렬 실행

#### Screen 설치
```bash
# Ubuntu/Debian
sudo apt-get install screen

# RHEL/CentOS/Fedora
sudo yum install screen
```

#### Screen 설정 파일 (`.screenrc-claude`)

```bash
# Claude Code 병렬 세션 설정
startup_message off
defscrollback 10000
term xterm-256color

# 화면 분할 및 세션 생성
split -v
split
split

# 각 영역에서 Claude Code 실행
screen -t "Frontend" 0 bash -c "cd frontend && claude-code --session frontend"
screen -t "Backend" 1 bash -c "cd backend && claude-code --session backend"
screen -t "Testing" 2 bash -c "cd tests && claude-code --session testing"
screen -t "Docs" 3 bash -c "cd docs && claude-code --session docs"

# 상태 표시줄
hardstatus alwayslastline
hardstatus string '%{= kG}[ %{G}%H %{g}][%= %{= kw}%?%-Lw%?%{r}(%{W}%n*%f%t%?(%u)%?%{r})%{w}%?%+Lw%?%?%= %{g}][%{B} %m-%d %{W}%c %{g}]'
```

#### 실행 스크립트 (`screen-parallel.sh`)

```bash
#!/bin/bash

# Screen 세션 시작
screen -c .screenrc-claude -S claude-parallel

# 또는 수동으로 세션 생성
create_screen_sessions() {
    local SESSION_NAME="claude-$1"
    
    # 새 screen 세션 생성
    screen -dmS $SESSION_NAME
    
    # 각 창 생성 및 명령 실행
    screen -S $SESSION_NAME -X screen -t "Frontend" bash -c "cd frontend && claude-code --session frontend"
    screen -S $SESSION_NAME -X screen -t "Backend" bash -c "cd backend && claude-code --session backend"
    screen -S $SESSION_NAME -X screen -t "Testing" bash -c "cd tests && claude-code --session testing"
    screen -S $SESSION_NAME -X screen -t "Docs" bash -c "cd docs && claude-code --session docs"
    
    echo "Screen session '$SESSION_NAME' created with 4 Claude Code instances"
    echo "Attach with: screen -r $SESSION_NAME"
}

create_screen_sessions "project"
```

### 3. 고급 Linux 자동화 스크립트

`advanced-parallel.sh`:

```bash
#!/bin/bash

set -e

# ===== 설정 =====
PROJECT_NAME="${PROJECT_NAME:-my-project}"
BASE_DIR="${BASE_DIR:-$(pwd)}"
LOG_DIR="$BASE_DIR/.claude/logs"
TODO_FILE="$BASE_DIR/.claude/todos/shared-todo.json"
MAX_SESSIONS="${MAX_SESSIONS:-4}"

# 색상 코드
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
MAGENTA='\033[0;35m'
CYAN='\033[0;36m'
WHITE='\033[1;37m'
NC='\033[0m'

# ===== 함수 정의 =====

# 로그 디렉토리 생성
create_log_dir() {
    mkdir -p "$LOG_DIR"
    echo -e "${GREEN}✅ Log directory created: $LOG_DIR${NC}"
}

# 공유 TODO 파일 생성
create_shared_todo() {
    mkdir -p "$(dirname "$TODO_FILE")"
    
    cat > "$TODO_FILE" <<EOF
{
  "project": "$PROJECT_NAME",
  "created": "$(date -Iseconds)",
  "sessions": [],
  "todos": [
    {"id": 1, "task": "Frontend: Implement UI components", "assignee": "session-1", "status": "pending"},
    {"id": 2, "task": "Backend: Create API endpoints", "assignee": "session-2", "status": "pending"},
    {"id": 3, "task": "Testing: Write test suites", "assignee": "session-3", "status": "pending"},
    {"id": 4, "task": "Docs: Generate documentation", "assignee": "session-4", "status": "pending"}
  ]
}
EOF
    
    echo -e "${GREEN}✅ Shared TODO file created: $TODO_FILE${NC}"
}

# Git worktree 설정 (선택사항)
setup_worktrees() {
    echo -e "${BLUE}Setting up Git worktrees...${NC}"
    
    local branches=("frontend" "backend" "testing" "docs")
    
    for branch in "${branches[@]}"; do
        if ! git worktree list | grep -q "$branch"; then
            git worktree add "../$PROJECT_NAME-$branch" -b "$branch" 2>/dev/null || true
            echo -e "${GREEN}  ✓ Worktree created: $branch${NC}"
        fi
    done
}

# tmux 세션 생성
create_tmux_session() {
    local session_name="claude-$PROJECT_NAME"
    
    # 기존 세션 제거
    tmux kill-session -t "$session_name" 2>/dev/null || true
    
    # 세션 설정 배열
    declare -A sessions=(
        ["frontend"]="src/frontend|/implement 'UI components' --persona-frontend --magic"
        ["backend"]="src/backend|/implement 'API endpoints' --persona-backend --seq"
        ["testing"]="tests|/test --comprehensive --persona-qa --play"
        ["docs"]="docs|/document --auto --persona-scribe --c7"
    )
    
    # 첫 번째 윈도우 생성
    tmux new-session -d -s "$session_name" -n "orchestrator" -c "$BASE_DIR"
    tmux send-keys -t "$session_name:orchestrator" "echo '🎯 Orchestrator Session'" C-m
    
    # 각 작업별 윈도우 생성
    local window_num=1
    for name in "${!sessions[@]}"; do
        IFS='|' read -r path command <<< "${sessions[$name]}"
        
        # 새 윈도우 생성
        tmux new-window -t "$session_name:$window_num" -n "$name" -c "$BASE_DIR/$path"
        
        # Claude Code 실행
        tmux send-keys -t "$session_name:$window_num" \
            "claude-code --session $name --resume" C-m
        
        sleep 1
        
        # 초기 명령 실행
        tmux send-keys -t "$session_name:$window_num" "$command" C-m
        
        echo -e "${GREEN}  ✓ Started $name session${NC}"
        
        ((window_num++))
    done
    
    # 모니터링 윈도우 생성
    tmux new-window -t "$session_name:$window_num" -n "monitor" -c "$BASE_DIR"
    tmux send-keys -t "$session_name:$window_num" \
        "watch -n 2 'echo \"=== Claude Code Sessions ===\" && ps aux | grep claude-code | grep -v grep'" C-m
    
    echo -e "${CYAN}━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━${NC}"
    echo -e "${GREEN}✅ tmux session '$session_name' created successfully!${NC}"
    echo -e "${YELLOW}📋 To attach: tmux attach-session -t $session_name${NC}"
    echo -e "${CYAN}━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━${NC}"
}

# 터미널 멀티플렉서 선택
select_multiplexer() {
    if command -v tmux &> /dev/null; then
        echo "tmux"
    elif command -v screen &> /dev/null; then
        echo "screen"
    else
        echo "none"
    fi
}

# 단순 터미널 실행 (멀티플렉서 없이)
run_simple_terminals() {
    echo -e "${YELLOW}⚠️  No terminal multiplexer found. Opening separate terminals...${NC}"
    
    local terminals=("gnome-terminal" "konsole" "xterm" "kitty" "alacritty")
    local term_cmd=""
    
    # 사용 가능한 터미널 찾기
    for term in "${terminals[@]}"; do
        if command -v "$term" &> /dev/null; then
            term_cmd="$term"
            break
        fi
    done
    
    if [ -z "$term_cmd" ]; then
        echo -e "${RED}❌ No supported terminal emulator found${NC}"
        exit 1
    fi
    
    # 각 세션별로 터미널 실행
    $term_cmd --title="Frontend" --working-directory="$BASE_DIR/frontend" \
        -e "bash -c 'claude-code --session frontend; exec bash'" &
    
    $term_cmd --title="Backend" --working-directory="$BASE_DIR/backend" \
        -e "bash -c 'claude-code --session backend; exec bash'" &
    
    $term_cmd --title="Testing" --working-directory="$BASE_DIR/tests" \
        -e "bash -c 'claude-code --session testing; exec bash'" &
    
    $term_cmd --title="Docs" --working-directory="$BASE_DIR/docs" \
        -e "bash -c 'claude-code --session docs; exec bash'" &
    
    echo -e "${GREEN}✅ Launched 4 terminal windows${NC}"
}

# 시스템 리소스 체크
check_resources() {
    echo -e "${BLUE}Checking system resources...${NC}"
    
    local mem_available=$(free -m | awk 'NR==2{printf "%.1f", $7/1024}')
    local cpu_cores=$(nproc)
    
    echo -e "  Memory available: ${WHITE}${mem_available}GB${NC}"
    echo -e "  CPU cores: ${WHITE}${cpu_cores}${NC}"
    
    if (( $(echo "$mem_available < 4" | bc -l) )); then
        echo -e "${YELLOW}⚠️  Warning: Low memory available. Performance may be affected.${NC}"
    fi
    
    if (( cpu_cores < MAX_SESSIONS )); then
        echo -e "${YELLOW}⚠️  Warning: Running $MAX_SESSIONS sessions on $cpu_cores cores.${NC}"
    fi
}

# 정리 함수
cleanup() {
    echo -e "\n${YELLOW}Cleaning up...${NC}"
    # 필요한 정리 작업 수행
    exit 0
}

# ===== 메인 실행 =====

# 시그널 핸들러 설정
trap cleanup INT TERM

# 배너 출력
echo -e "${CYAN}━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━${NC}"
echo -e "${WHITE}   Claude Code Parallel Execution Manager${NC}"
echo -e "${CYAN}━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━${NC}"

# 리소스 체크
check_resources

# 디렉토리 및 파일 생성
create_log_dir
create_shared_todo

# Git worktree 설정 (선택사항)
read -p "Do you want to set up Git worktrees? (y/n) " -n 1 -r
echo
if [[ $REPLY =~ ^[Yy]$ ]]; then
    setup_worktrees
fi

# 멀티플렉서 선택 및 실행
multiplexer=$(select_multiplexer)

case $multiplexer in
    tmux)
        create_tmux_session
        
        # 세션 연결 옵션
        read -p "Attach to tmux session now? (y/n) " -n 1 -r
        echo
        if [[ $REPLY =~ ^[Yy]$ ]]; then
            tmux attach-session -t "claude-$PROJECT_NAME"
        fi
        ;;
    screen)
        echo -e "${BLUE}Starting screen sessions...${NC}"
        # Screen 구현 (위의 screen 스크립트 참조)
        ;;
    none)
        run_simple_terminals
        ;;
esac

echo -e "${CYAN}━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━${NC}"
echo -e "${GREEN}🎉 Parallel execution setup complete!${NC}"
echo -e "${CYAN}━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━${NC}"
```

## 공통 설정

### 1. 공유 TODO 파일 구조

`.claude/todos/shared-todo.json`:

```json
{
  "project": "my-project",
  "version": "1.0.0",
  "created": "2024-01-01T00:00:00Z",
  "updated": "2024-01-01T00:00:00Z",
  "sessions": [
    {
      "id": "session-1",
      "name": "frontend",
      "type": "development",
      "status": "active",
      "assigned_tasks": [1, 5, 9],
      "completed_tasks": [],
      "working_directory": "./frontend",
      "focus_files": ["*.jsx", "*.tsx", "*.css"]
    },
    {
      "id": "session-2",
      "name": "backend",
      "type": "development",
      "status": "active",
      "assigned_tasks": [2, 6, 10],
      "completed_tasks": [],
      "working_directory": "./backend",
      "focus_files": ["*.js", "*.ts", "*.sql"]
    }
  ],
  "todos": [
    {
      "id": 1,
      "title": "Create login component",
      "description": "Implement login form with validation",
      "assignee": "session-1",
      "status": "in_progress",
      "priority": "high",
      "dependencies": [],
      "created": "2024-01-01T00:00:00Z",
      "updated": "2024-01-01T00:00:00Z"
    },
    {
      "id": 2,
      "title": "Create auth API",
      "description": "Implement JWT authentication endpoints",
      "assignee": "session-2",
      "status": "in_progress",
      "priority": "high",
      "dependencies": [],
      "created": "2024-01-01T00:00:00Z",
      "updated": "2024-01-01T00:00:00Z"
    }
  ]
}
```

### 2. 세션 간 동기화 설정

`.claude/settings.json`:

```json
{
  "parallelExecution": {
    "enabled": true,
    "maxSessions": 8,
    "sharedTodoPath": ".claude/todos/shared-todo.json",
    "lockingStrategy": "optimistic",
    "syncInterval": 5000,
    "conflictResolution": "latest-write-wins"
  },
  "sessionDefaults": {
    "autoResume": true,
    "contextPreservation": true,
    "shareContext": true,
    "logLevel": "info"
  },
  "resourceLimits": {
    "maxTokensPerSession": 100000,
    "maxMemoryPerSession": "2GB",
    "cpuThrottling": false
  }
}
```

### 3. 작업 분배 전략

`task-distribution.yaml`:

```yaml
distribution_strategies:
  by_domain:
    frontend:
      paths: [src/components, src/pages, src/styles]
      file_patterns: ["*.jsx", "*.tsx", "*.css", "*.scss"]
      agents: [frontend-developer, ui-ux-designer]
      
    backend:
      paths: [src/api, src/services, src/models]
      file_patterns: ["*.js", "*.ts", "*.py", "*.go"]
      agents: [backend-developer, database-optimizer]
      
    testing:
      paths: [tests, __tests__, e2e]
      file_patterns: ["*.test.*", "*.spec.*"]
      agents: [qa, test-automator]
      
    infrastructure:
      paths: [.github, docker, k8s, terraform]
      file_patterns: ["*.yml", "*.yaml", "Dockerfile", "*.tf"]
      agents: [devops-troubleshooter, cloud-architect]

  by_feature:
    user_authentication:
      sessions_required: 3
      tasks:
        - {session: 1, task: "UI: Login/Register forms"}
        - {session: 2, task: "API: Auth endpoints"}
        - {session: 3, task: "Tests: Auth flow testing"}
        
    payment_system:
      sessions_required: 4
      tasks:
        - {session: 1, task: "UI: Payment forms"}
        - {session: 2, task: "API: Payment processing"}
        - {session: 3, task: "Integration: Payment gateway"}
        - {session: 4, task: "Tests: Payment testing"}
```

## 실전 예제

### 1. E-commerce 프로젝트 병렬 개발

```bash
# Windows (PowerShell)
.\start-ecommerce-parallel.ps1

# Linux (Bash)
./start-ecommerce-parallel.sh
```

`start-ecommerce-parallel.sh`:

```bash
#!/bin/bash

PROJECT="ecommerce"
SESSIONS=6

# 세션 구성
declare -A SESSION_CONFIG=(
    ["1"]="frontend|Product Catalog UI"
    ["2"]="backend|Product API"
    ["3"]="payment|Payment Integration"
    ["4"]="cart|Shopping Cart Logic"
    ["5"]="testing|E2E Testing"
    ["6"]="docs|API Documentation"
)

# tmux 세션 생성
tmux new-session -d -s "$PROJECT"

for i in {1..6}; do
    IFS='|' read -r type task <<< "${SESSION_CONFIG[$i]}"
    
    if [ $i -eq 1 ]; then
        tmux send-keys -t "$PROJECT" "claude-code --session $type" C-m
    else
        tmux new-window -t "$PROJECT:$i" -n "$type"
        tmux send-keys -t "$PROJECT:$i" "claude-code --session $type" C-m
    fi
    
    sleep 1
    tmux send-keys -t "$PROJECT:$i" "/implement '$task'" C-m
done

tmux attach-session -t "$PROJECT"
```

### 2. 마이크로서비스 병렬 개발

```yaml
# microservices-parallel.yaml
services:
  user-service:
    session: 1
    path: ./services/user
    command: /implement "User management service"
    
  product-service:
    session: 2
    path: ./services/product
    command: /implement "Product catalog service"
    
  order-service:
    session: 3
    path: ./services/order
    command: /implement "Order processing service"
    
  gateway:
    session: 4
    path: ./gateway
    command: /implement "API Gateway"
```

### 3. 모니터링 대시보드

`monitor-sessions.sh`:

```bash
#!/bin/bash

while true; do
    clear
    echo "=== Claude Code Parallel Sessions Monitor ==="
    echo "Time: $(date)"
    echo ""
    
    # 프로세스 상태
    echo "Active Sessions:"
    ps aux | grep "claude-code" | grep -v grep | awk '{print $2, $11, $12}'
    
    echo ""
    echo "Resource Usage:"
    # CPU 사용률
    top -bn1 | grep "claude" | head -5
    
    echo ""
    echo "TODO Status:"
    # TODO 파일 상태 체크
    if [ -f ".claude/todos/shared-todo.json" ]; then
        jq '.todos[] | select(.status != "completed") | {id, title, assignee, status}' \
            .claude/todos/shared-todo.json
    fi
    
    sleep 5
done
```

## 문제 해결

### 공통 문제와 해결 방법

#### 1. 파일 충돌
```bash
# Git 충돌 해결
git stash
git pull
git stash pop

# 자동 병합
git config merge.tool vimdiff
git mergetool
```

#### 2. 메모리 부족
```bash
# Linux: 스왑 파일 추가
sudo fallocate -l 4G /swapfile
sudo chmod 600 /swapfile
sudo mkswap /swapfile
sudo swapon /swapfile

# Windows: 가상 메모리 증가
# 시스템 속성 > 고급 > 성능 설정 > 가상 메모리
```

#### 3. 세션 동기화 실패
```bash
# 잠금 파일 제거
rm .claude/todos/.lock

# 세션 재시작
tmux kill-session -t claude-parallel
./parallel-claude-linux.sh
```

#### 4. 포트 충돌
```bash
# 사용 중인 포트 확인
netstat -tulpn | grep claude

# 프로세스 종료
kill -9 <PID>
```

### 성능 최적화 팁

1. **CPU 코어 할당**
   ```bash
   # Linux: taskset을 사용한 CPU 친화도 설정
   taskset -c 0,1 claude-code --session frontend
   taskset -c 2,3 claude-code --session backend
   ```

2. **메모리 제한**
   ```bash
   # Linux: cgroups 사용
   cgcreate -g memory:/claude
   echo 2G > /sys/fs/cgroup/memory/claude/memory.limit_in_bytes
   cgexec -g memory:claude claude-code
   ```

3. **I/O 우선순위**
   ```bash
   # Linux: ionice 사용
   ionice -c 2 -n 0 claude-code --session critical
   ionice -c 3 claude-code --session background
   ```

## 결론

병렬 Claude Code 실행은 대규모 프로젝트 개발 속도를 크게 향상시킬 수 있습니다. 
적절한 작업 분배와 리소스 관리를 통해 효율적인 개발 환경을 구축할 수 있습니다.

### 핵심 포인트
- 작업을 독립적인 영역으로 분리
- 세션 간 충돌 최소화
- 리소스 모니터링 및 최적화
- 자동화 스크립트 활용

### 추가 리소스
- [tmux 매뉴얼](https://github.com/tmux/tmux/wiki)
- [Windows Terminal 문서](https://docs.microsoft.com/windows/terminal/)
- [GNU Screen 가이드](https://www.gnu.org/software/screen/manual/)